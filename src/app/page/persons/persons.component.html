@let persons = persons$ | async;

<div class="flex flex-col h-full">
  <div class="flex items-center justify-between">
    <h2></h2>
    <app-input class="md:w-1/3" label="Personnes" [placeholder]="'app.search' | translate" [total]="total"
      (change)="onSearch($event)">
    </app-input>
    <app-toolbar [countries$]="countries$" [selectedCriterias]="searchConfig$?.value?.criterias"
      [criterias]="['birthDate', 'deathDate', 'countries', 'creationDate', 'lastUpdate']" [sorts]="sorts$ | async"
      [cookieName]="'persons-config'" (filter)="onFilter($event)" (switchView)="onSwitchView($event)"
      (sort)="onSort($event)">
    </app-toolbar>
  </div>

  @if (searchConfig$?.value?.criterias?.countries?.length) {
  <app-criterias-reminder [criterias]="searchConfig$.value.criterias" (deleteCountry)="onDeleteCountry($event)">
  </app-criterias-reminder>
  }

  @if (searchConfig$.value.view == view.CARDS) {
  <div #scrollContainer class="grow overflow-y-auto" infiniteScroll [scrollWindow]="false" [infiniteScrollDistance]="1"
    [alwaysCallback]="true" (scrolled)="onScroll()">
    <app-persons-list [persons]="persons"></app-persons-list>
  </div>
  } @else {
  <div #tableContainer class="grow max-h-fit overflow-y-auto rounded-t-lg">
    <app-persons-table [dataSource]="persons" [sortActive]="searchConfig$.value.sort"
      [sortDirection]="searchConfig$.value.direction" (sort)="onSort($event)">
    </app-persons-table>
  </div>
  @if (persons?.length) {
  <mat-paginator #paginator class="rounded-b-lg" [pageSizeOptions]="pageSizeOptions" [length]="total"
    [pageSize]="searchConfig$.value.size" [showFirstLastButtons]="true" (page)="onPageChange($event)"
    aria-label="Select page of Movie search results">
  </mat-paginator>
  }
  }
</div>